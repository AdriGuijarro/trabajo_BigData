---
title: "PIB espa침ol y Capital humano"
description: |
  La importancia del capital humano y la educaci칩n
author:
  - name: Adri치n Guijarro
    affiliation: Universitat de Val칟ncia
    affiliation-url: https://www.uv.es
date: 2024-01-22                           #--
categories: [trabajo BigData, PIB, Capital Humano, PTF]   #--
image: "./imagenes/lucas.jpg"
title-block-banner: true #- {true, false, "green","#AA0000"}
title-block-banner-color: "snow"    #-"#FFFFFF" 
toc-depth: 3
smooth-scroll: true
format: 
  html:
    backgroundcolor: "#F1F3F4"
    #embed-resources: true
    link-external-newwindow: true
    css: ./assets/my_css_file.css   #- CUIDADO!!!!
code-tools: true
code-link: true
---


## 0. Intro 

En los 칰ltimos tiempos, se est치  reavivando el debate p칰blico y en el mundo acad칠mico de los problemas que adolece la econom칤a espa침ola. La mayor parte de acad칠micos alcanzan una misma conclusi칩n, la productividad espa침ola lleva practicamente dos d칠cadas estancada. Recientemente la Fundaci칩n BBVA y el Ivie publicaron un informe en el que se muestra la comparativa de la evoluci칩n de la productividad espa침ola junto a otros pa칤ses de la OCDE^[<https://www.fbbva.es/noticias/informe-productividad-competencia-espana/>]. Resulta muy llamativo observar que para el **periodo 2000-2022** la tasa de **variaci칩n acumulada de la productividad total de los factores** fue de un **-7,3%**, mientras que para pa칤ses tales que, Alemania o Reino Unido la evoluci칩n fue muy diferente(11,8% y 8,8%, respectivamente).

Este problema como veremos a continuaci칩n, generar치 dificultades para mejorar el nivel de vida de la poblaci칩n espa침ola, adem치s, limita la competitividad internacional debido a la menor eficiencia de nuestro sistema productivo.

En este trabajo analizar칠 las consecuencias a largo plazo que tendr치 el estancamiento de la productividad espa침ola, adem치s, propondr칠 una mejora en el desarrollo del capital humano como medida para mejorar la productividad, bas치ndome en las teor칤as de crecimiento 칠ndogeno. Para ello los datos han sido extra칤dos del `Banco de Espa침a` y de las Penn World Tables a trav칠s del package `pwt10`.


```{r}
#| warning: false
library(pwt10)
library(rio)
library(tidyverse)
library(highcharter)
library(gt)
library(gtExtras)
library(ggthemes)
library(RColorBrewer)
library(plotly)
library(stargazer)
library(jtools)
library(DT)

```



---

## 1. Evoluci칩n del PIB per c치pita para diversos pa칤ses


En primer lugar, he realizado un gr치fico donde se puede ver la serie hist칩rica de la evoluci칩n del PIB per c치pita para diferentes p치ises. Los datos de PIB est치n medidos en d칩lares de 2017 y ajustados por Paridad de Poder Adquisitivo (PPA).

Cabe destacar que se pueden observar dos grupos de pa칤ses. Uno formado por p치ises de renta m치s alta (EEUU, Alemania, Francia) y otro con rentas m치s bajas (Espa침a, Portugal o Italia). En el presente trabajo trataremos de desentra침ar que es lo que nos ha llevado a ser uno de estos pa칤ses con un PIB per cap칤ta relativamente m치s bajo y como podemos aumentarlo de cara al futuro.


```{r}
df_2 <- pwt10.01

 df_3 <- df_2 %>%
   filter(country %in% c("Spain", "France", "Germany", "Italy", "Portugal","United States of America", "Japan")) %>% select(country, year, pop, rgdpna, rgdpe, rgdpo,hc) %>% 
   mutate(pib_pc = rgdpo/pop,
          pib_pc = round(pib_pc,2))
 
hc_2 <- df_3 %>% hchart('line', hcaes(x = 'year', y = 'pib_pc', group = 'country')) %>%
   hc_title(text = "Evoluci칩n PIB per c치pita,PPA($ de 2017)") %>%
   hc_caption(text = "Fuente:Penn World Tables 10.01") %>%
   hc_yAxis(title =  "PIB per c치pita") %>%
   hc_xAxis(title =  NULL)
   
 hc_2
```


## 2. PIB espa침ol desagregado

En este punto, analizaremos la tasa de variaci칩n del PIB as칤 como su descomposici칩n.

En el gr치fico siguiente observamos ciertos valores que destacan a simple vista. Por ejemplo, en el a침o 1961 tuvo lugar una tasa de crecimiento del PIB del 11,84%, causada mas que probalmente por la entrada en vigor del Plan de Estabilizacion en 1959. Otro dato a destacar es que en el a침o 2009 con la Gran Recesi칩n se produjo la mayor ca칤da del PIB de la serie estudiada(No he recogido datos hasta 2020).

Respecto a los componentes del PIB, es interesante ver como el consumo se comporta de manera proc칤clica, casi replicando los movimientos del PIB. Adem치s del consumo, el otro componente que merece la pena resaltar es el gasto p칰blico, el c칰al, practicamente solo se ha visto reducido tras el a침o 2012 y el rescate de Europa.

```{r}
ruta <- "./datos/datos_esp.xlsx"
df <- rio::import(ruta)
df <- df %>% rename(C = `Consumo privado`,
                    G = `Gasto P칰blico`,
                    I = `Inversi칩n`,
                    X = `Exportaci칩n de bienes y servicios`,
                    M = `Importaci칩n de bienes y servicios`)

df <- df %>% mutate(M = M*-1)

df <- df %>% pivot_longer(cols = 3:7, names_to = "componentes", values_to = "saldo")


df <- df %>% group_by(componentes) %>% 
  mutate(var_saldo_pib = ((saldo - lag(saldo))/lag(PIB))*100)

df <- df %>% mutate(variacion_pib  = ((PIB - lag(PIB))/lag(PIB))*100)

g <- ggplot(data = df) + 
  geom_bar(data = df,aes(x = a침o, y = var_saldo_pib,  fill = componentes),position = "stack", stat = "identity") +
  geom_line(data = df, aes(a침o,variacion_pib), color = "red")

df <- df %>% mutate(var_saldo_pib = round(var_saldo_pib, 2),
                    variacion_pib = round(variacion_pib, 2))

hc <- df %>% 
  hchart(
    'column', hcaes(x = 'a침o', y = 'var_saldo_pib', group = 'componentes'),
    stacking = "normal") %>%
  hc_add_series(df, "line", hcaes(a침o, variacion_pib), name = "PIB") %>%
  hc_title(text = "Tasa de crecimiento del PIB y sus componentes")  %>%
  hc_xAxis(title = list(text = NULL)) %>%
  hc_yAxis(title = list(text = "Porcentaje(%)")) %>%
  hc_caption(text = "Fuente: Banco de Espa침a")
hc
```




## 3. Descomponiendo el PIB per c치pita

En esta secci칩n he utilizado los datos de las Penn World Tables (PWT) para desagregar el PIB per c치pita espa침ol y conocer mejor que hay detr치s de este indicador. El PIB per capita puede descomponerse de la siguinete forma:

$$\ PIBpc = (PIB/empleo)*(empleo/poblaci칩n)$$
Esta expresi칩n nos muestra que el PIB per c치pita esta compuesto por la productividad del trabajo (PIB/ empleo) y del empleo per c치pita (empleo/poblaci칩n). En la tabla siguiente encontramos los resultados de la descomposici칩n de la renta per c치pita con datos desde el a침o 1951.
<br><br>



```{r}
df_product_1 <- df_2 %>% select(country, year, rgdpo, emp, pop) %>%
  filter(country == "Spain") %>%
  mutate(tc_pib = (rgdpo-lag(rgdpo))/lag(rgdpo),
         tc_pop = (pop-lag(pop))/lag(pop),
         tc_emp = (emp-lag(emp))/lag(emp)) %>%
  mutate(tc_pib_pc = (tc_pib-tc_emp) + (tc_emp - tc_pop)) 


df_product_2 <- df_product_1 %>% mutate(tc_p_l = (tc_pib - tc_emp)*100,
                                    tc_emp_pc = (tc_emp - tc_pop)*100,
                                    tc_pib_pc = tc_pib_pc*100) %>%
  select(country, year, tc_pib_pc, tc_p_l, tc_emp_pc) %>%
  filter(!year == 1950) %>%
  select(!country) %>%
  mutate(`Contribuci칩n Productividad` = (tc_p_l/tc_pib_pc)*100,
         `Contribuci칩n empleo per c치pita` = (tc_emp_pc/tc_pib_pc)*100) %>%
  rename(`PIB per c치pita`= tc_pib_pc,
         `Empleo per c치pita` = tc_emp_pc,
         `Productividad del trabajo` = tc_p_l,
         A침o = year) %>%
  mutate(`PIB per c치pita`= round(`PIB per c치pita`,2),
         `Empleo per c치pita`= round(`Empleo per c치pita`,2),
         `Productividad del trabajo` = round(`Productividad del trabajo`,2),
         `Contribuci칩n Productividad`= round(`Contribuci칩n Productividad`,2),
         `Contribuci칩n empleo per c치pita`= round(`Contribuci칩n empleo per c치pita`,2)
         
         )

## TABLA GT
tabla <- DT::datatable(df_product_2,
                       class = 'cell-border stripe',
                       caption = "Descomposici칩n del PIB per c치pita en tasas de variaci칩n",
                       colnames = c("A침o", "PIB per c치pita", "Productividad del trabajo", "Empleo per c치pita", "Contribuci칩n Productividad(%)","Contribuci칩n empleo per c치pita(%)")) %>%
  formatStyle(c("Productividad del trabajo","Contribuci칩n Productividad" ), 
    backgroundColor = 'lightblue',
    fontWeight = "bold") %>%
  formatStyle(c("Empleo per c치pita", "Contribuci칩n empleo per c치pita"),
              backgroundColor = "palegreen",
              fontWeight = "bold") %>%
  formatStyle("PIB per c치pita",
              backgroundColor = "aquamarine",
              fontWeight = "bold")
tabla


```
<br><br>

Las tasas de crecimiento de la productividad fueron bastante altas desde los 50 hasta las crisis del petr칩leo, momento en el que se empieza a ralentizar el avance. Durante los a침os 2000 el crecimiento es muy poco significativo, debido a que los mayores avances se dieron entre los a침os 2005-2007(a침os influenciados por la burbuja inmobiliraria). A partir de estos a침os se puede observar que sigue siendo positiva la tasa de crecimiento de la productivid, no obstante, esto se debe a un fenomeno estad칤stico. Hemos definido la productividad del trabajo como:$$ productividad = PIB/empleo$$

Por tanto el **incremento de la productividad en estos a침os se debe tan solo a la masiva destrucci칩n de empleo** que sufri칩 la econom칤a espa침ola como consecuencia de la crisis financiera de 2008. Para visualizar de manera m치s clara las variaciones en los componenetes del PIB per c치pita he realizado la siguiente gr치fica:
```{r}
df_plot <- df_product_2 %>% select(`A침o`,`PIB per c치pita` , `Productividad del trabajo`, `Empleo per c치pita`)

df_plot <- df_plot %>% pivot_longer(cols = 3:4, names_to = "componentes_pibpc", values_to = "tasa_variacion")

df_plot <- df_plot %>% mutate(Componentes = componentes_pibpc)

plot <- ggplot() + 
  geom_bar(data = df_plot,aes(x = A침o, y = tasa_variacion,  fill = Componentes),position = "stack", stat = "identity") + 
  geom_line(data = df_plot, aes(A침o, `PIB per c치pita`), color = "darkblue") +
  theme_economist_white() +
  scale_x_continuous(breaks = seq(1955,2020,5)) +
  labs(title = "Descomposici칩n del PIB per c치pita",
       subtitle = "Tasas de variaci칩n en %",
       guides = NULL, 
       x = NULL,
       y = NULL,
       caption = "Fuente: Penn World Tables 10.01",
       color = "componentes") 
plot
```

Este escenario nos lleva a una situaci칩n en la que la productividad del trabajo ha crecido de una manera poco significativa en los 칰ltimos 20 a침os. Uno de los factores que explican este resultado es el estancamiento de la productividad total de los factores(PTF). Como se puede observar a continuaci칩n, los incrementos de la productividad iban muy ligados a aumentos de la PTF. No obstante, en los a침os 2000 las mejoras en la PTF son muy reducidos generando problemas para conseguir mejoras en la productividad del trabajo. Por tanto nos encontramos con que la econom칤a espa침ola lleva dos d칠cadas perdidas en el avance de su productividad total de los factores.
<br><br>

```{r}
pl <- df_4 <- df_2 %>%
  filter(country== "Spain") %>%
  select(year,country,rtfpna) %>%
  mutate(var_ptf = (rtfpna- lag(rtfpna))/lag(rtfpna),
         var_ptf_per = var_ptf*100)


ptf <- ggplot()+
  geom_col(data = pl, aes(year,var_ptf_per, fill = "PTF")) +
  geom_line(data = df_product_2, aes( x = A침o, y =`Productividad del trabajo`, color = "Productividad del trabajo")) +
  scale_fill_manual(values = "#6B8E23", name = NULL) +
  scale_color_manual(values = "#2F4F4F", name = NULL) +
  theme_hc() +
  labs(title = "Evoluci칩n de la productividad del trabajo y la PTF",
       subtitle = "Tasa de variaci칩n en %",
       caption = "Fuente: Penn World Tables 10.01",
       y = NULL,
       x = NULL,
       fill = NULL,
       color = NULL)
  
ptf
```


---

## 4. Importancia del capital humano

La PTF es comunmente llamada como **"el residuo de Solow"**. El residuo de Solow recibe este nombre en honor al gigante de la econom칤a Robert Solow (recientemente fallecido a los 99 a침os, DEP Bob) cuyo famoso modelo hemos estudiado todos a lo largo de la carrera. El residuo basicamente viene a representar aquella proporci칩n del output que no se puede explicar por las aportaciones de los factores productivos (Capital y Trabajo). Seg칰n el modelo de Solow, este residuo est치 determinado de forma ex칩gena, es decir, viene dado, y por tanto el crecimiento de la renta per c치pita de una econom칤a a largo plazo que depende de dicho residuo tambi칠n ser치 ex칩geno. Este resultado es claramente insatisfactorio ya que seg칰n el modelo de Solow no se podria alterar la tasa de crecimiento del PIB per c치pita a largo plazo a trav칠s de medidas de polit칤ca econ칩mica.

Esta insatisfacc칩n llevo a los economistas a desarrollar una nueva clase de modelos. En los a침os 80 del siglo pasado aparecieron estos nuevos modelos conocidos como **"modelos de crecimiento end칩geno"**. En este nuevo tipo de modelos los determinantes del crecimiento se determinan de manera end칩gena al modelo (al contrario de lo que ocurr칤a en el modelo de Solow), y por tanto, s칤 que se puede ver afectada la tasa de crecimiento de la renta per c치pita a largo plazo.

Entre los modelos de crecimiento end칩geno m치s importantes destacan: **El modelo de Lucas** (desarrollado por el economista Robert Lucas, tamb칤en conocido por la famosa "Critica de Lucas" y sus aportaciones a las expectativas racionales), el cu치l incluye en su funci칩n de producci칩n el capital humano, asi como, el tiempo dedicado a acumular el mismo. Otro modelo a destacar es el de Romer, qui칠n introduce la inversi칩n en I+D como potenciador de la productividad y por tanto del crecimiento. Adem치s existen muchos otros modelos de crecimiento end칩geno desarrollados por importantes econmistas tales que: Barro, Rebelo o m치s recientemente, Acemoglu.

Lo apropiado en esta secci칩n habr칤a sido estimar alguno de estos modelos de crecimiento end칩geno para observar si los datos respaldan dichas teor칤as, no obstante, dado el grado de complejidad requerido, he decidido realizar un an치lisis no tan riguroso pero que resalta la importancia de la educaci칩n en el crecimiento.

En primer lugar he estimado una funci칩n de producci칩n Cobb Douglas que incluye el capital humano:

$$ Y = A \cdot K^\alpha \cdot (LH)^\beta $$
Por tanto el modelo a estimar ser치: 
$$\ln(Y_t) = \beta_1 + \beta_2\ln(K) + \beta_3\ln(L) + \beta_4ln(H) + u_t$$


```{r}
df_cb <- df_2 %>%
  select(country, year, emp, avh, rnna, rgdpo, hc) %>%
  mutate(k = rnna,
         l = avh*emp,
         gdp = rgdpo)


model <- lm(log(gdp) ~ log(k) + log(l) + log(hc), data = df_cb)
 # stargazer(model, type = "html")
summ(model)

```

La estimaci칩n realizada recoge la muestra de todos los pa칤ses que aparecen en las PWT. Como se puede observar, la variable del capital humano es **estadisticamente significativa**, no solo eso, si no que posee el coeficiente m치s grande. Por otra parte tamb칤en cabe destacar que el modelo se ajusta casi perfectamente con un  R^2^  de 0.95.

```{r}
df_2019 <- df_2 %>% filter(year == 2019) %>%
  mutate(pib_pc = rgdpo/pop) %>%
  select(country,year,pib_pc, hc, pop) %>%
  mutate(pib_pc = round(pib_pc, 2),
         hc = round(hc, 2)) %>%
  rename(`PIB per c치pita` = pib_pc,
         `Capital Humano` = hc,
         `Poblaci칩n` = pop,
         Pa칤s = country)

gg <- ggplot(data = df_2019, aes(`PIB per c치pita`, `Capital Humano`, size = `Poblaci칩n`, color = `Capital Humano`, label = Pa칤s)) +
  geom_point() +
  geom_smooth(method = "lm") +
  labs(title = "Capital Humano vs PIB per c치pita,PPA($ de 2017)",
       caption = "Fuente: Penn World Tables 10.01",
       xlab = NULL,
       ylab = NULL) +
  scale_x_continuous(labels = scales::dollar_format()) +
  theme_few()
ggplotly(gg)
```

La relaci칩n entre capital humano y renta per c치pita tamb칤en se puede observar en el gr치fico anterior, donde se refleja el PIB per c치pita en el a침o 2019, la poblaci칩n(en millones de personas) y el 칤ndice de capital humano. Claramente se observa la **correlaci칩n positiva entre renta per c치pita y capital humano**. Aunque sabemos que correlaci칩n no tiene porque implicar causalidad, los modelos de crecimiento 칠ndogeno mencionados anteriormente si que corroboran dicho efecto causal y por tanto, si queremos parecernos a otros pa칤ses de Europa en cuanto a nivel de PIB per c치pita se refiere, deberemos mejorar nuestros niveles de capital humano. Esta mejora del capital humano conseguir치 incrementar la productividad del trabajo y por tanto la renta de la poblaci칩n espa침ola en el largo plazo.



## Conclusi칩n
Finalmente, me gustar칤a resaltar que el estancamiento de la productividad espa침ola es problem치tico, debido a que, sin mejoras en la productividad no conseguiremos hacer crecer nuestra renta en el largo plazo, y por tanto, tampoco lo har치 el nivel de vida de nuestros ciudadanos.

En este trabajo he intentado resaltar la importancia del capital humano debido a su capacidad de  generar mayores niveles de productividad, as칤 como,  su relevancia como factor de producci칩n a tener en cuenta junto al capital f칤sico y al trabajo.

Dicha mejora del capital humano debe venir de la mano de la **mejora en el proceso de acumulaci칩n de capital humano**, el cu치l, est치 estrechamente relacionado con el sistema educativo. La mejora de la educaci칩n formal no tiene que venir solo de posibles aumentos del gasto en educaci칩n, sino que, se debe hacer enfasis en los m칠todos de aprendizaje o en los propios contenidos impartidos. Actualmente nos encontramos con planes de estudio en universidades totalmente desfasados y paralelos al mundo profesional, donde se ense침an conocimientos y habiliadades que no se demandan en el mercado laboral(Menos mal que lleg칩 Pedro para ense침arnos R...游땔).

Por 칰ltimo (ahora de verdad), considero que m치s asiganturas como esta deber칤an ser a침adidas en el plan de Econom칤a, ya no solo porque muchas de las asignaturas que nos imparten son pr치cticamente una p칠rdida de tiempo, sino porque asignaturas como programaci칩n te ayudan a desarrollar una skill b치sica en el mundo de la Econom칤a, la cu치l es altamente demandada, bien quieras dedicarte al mundo profesional o al mundo de la investigaci칩n.

<br>

----------------------

<br>

### Informaci칩n sobre la sesi칩n

Abajo muestro mi entorno de trabajo y paquetes utilizados

```{r}
#| echo: false
sessioninfo::session_info() %>% 
  details::details(summary = 'current session info') 
```



